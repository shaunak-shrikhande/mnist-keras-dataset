import numpy as np
import tensorflow as tf
from tensorflow.keras.models import load_model

model = load_model("mnist_cnn_high_accuracy.keras")

img = tf.keras.utils.load_img(
    "zero.png",
    color_mode="grayscale",
    target_size=(28, 28)
)

img_array = tf.keras.utils.img_to_array(img)
img_array = img_array/ 255.0
img_array = np.expand_dims(img_array, axis=0)

# invert if needed
img_array = 1.0 - img_array

prediction = model.predict(img_array)

print("Predicted digit:", np.argmax(prediction))

